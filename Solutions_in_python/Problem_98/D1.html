<!DOCTYPE HTML>
<html><head><style> body { margin: 0px; padding: 0px; } </style>
<script>
//<![CDATA[
    function Direction(x,y) { this.x=x; this.y=y; }
    function TestCase(T,W,H,mex,mey,D) { this.T=T; this.W=W; this.H=H; this.mex=mex; this.mey=mey; this.D=D; }
    function sameDirection(d1,d2) { return (d1.x*d2.y == d2.x*d1.y) && (d1.x*d2.x + d1.y*d2.y > 0); }
    function getDirection(dx,dy,xdiff1,xdiff2,ydiff1,ydiff2) {
        var cx=0, cy=0;
        if (dx>0) for (var i=0; i<dx; ++i) if (i%2) cx+=2*xdiff1; else cx+=2*xdiff2;
        if (dx<0) for (var i=0; i<-dx; ++i) if (i%2) cx-=2*xdiff2; else cx-=2*xdiff1;
        if (dy>0) for (var i=0; i<dy; ++i) if (i%2) cy+=2*ydiff1; else cy+=2*ydiff2;
        if (dy<0) for (var i=0; i<-dy; ++i) if (i%2) cy-=2*ydiff2; else cy-=2*ydiff1;
        return new Direction(cx,cy);
    }

    function solveTestCase(id) {
        var canvas = document.getElementById("myCanvas"), context = canvas.getContext("2d"), tc = window.testCases[id];
        var sizex = canvas.width, sizey = canvas.height, offx = sizex/2, offy = sizey/2, mul = 5, xdiff1 = tc.mex-2, xdiff2 = tc.W-2-tc.mex, ydiff1 = tc.mey-2, ydiff2 = tc.H-2-tc.mey, found = [];

        context.clearRect(0,0,sizex,sizey);
        context.fillStyle = "blue";  context.fillRect(offx,offy,mul*tc.W,mul*tc.H);
        context.fillStyle = "white"; context.fillRect(offx+2*mul,offy+2*mul,mul*(tc.W-4),mul*(tc.H-4));
        context.fillStyle = "green"; context.beginPath(); context.arc(offx+mul*tc.mex,offy+mul*tc.mey,mul,0,2*Math.PI,false); context.fill();

        for (var dx=-tc.D; dx<=tc.D; ++dx) for (var dy=-tc.D; dy<=tc.D; ++dy) {
            var dir=getDirection(dx,dy,xdiff1,xdiff2,ydiff1,ydiff2);
            if (dir.x*dir.x + dir.y*dir.y > tc.D*tc.D) continue;
            context.beginPath(); context.arc(offx+mul*(tc.mex+dir.x),offy+mul*(tc.mey+dir.y),mul,0,2*Math.PI,false); context.fill();
            var add=true; for (var n = 0; n < found.length; n++) if (sameDirection(dir,found[n])) { add=false; break; } if (add) found.push(dir);
        }
        context.strokeStyle = "red";
        for (var dx=-tc.D; dx<=tc.D; ++dx) for (var dy=-tc.D; dy<=tc.D; ++dy) {
            var dir=getDirection(dx,dy,xdiff1,xdiff2,ydiff1,ydiff2);
            if (dir.x*dir.x + dir.y*dir.y > tc.D*tc.D) continue;
            context.beginPath(); context.moveTo(offx+mul*tc.mex,offy+mul*tc.mey); context.lineTo(offx+mul*tc.mex+sizex*dir.x,offy+mul*tc.mey+sizey*dir.y); context.stroke();
        }

        console.log("Case #"+tc.T+": "+(found.length-1));
    }
    
    function dropdownHandler() {
        var dropdown = document.getElementById("currentTest");
        var v = dropdown.options[dropdown.selectedIndex].value;
        if (v>0) solveTestCase(v-1); else { var canvas = document.getElementById("myCanvas"); canvas.getContext("2d").clearRect(0,0,canvas.width,canvas.height); }
    }

    window.onload = function(){
        window.testCases = [];
        window.testCases.push(new TestCase(1,6,6,3,3,2));
        window.testCases.push(new TestCase(2,6,6,3,3,4));
        window.testCases.push(new TestCase(3,22,54,7,39,48));
        window.testCases.push(new TestCase(4,52,18,7,7,42));
        window.testCases.push(new TestCase(5,16,52,11,45,32));
        window.testCases.push(new TestCase(6,34,60,3,21,64));
        window.testCases.push(new TestCase(7,52,18,5,15,80));
        window.testCases.push(new TestCase(8,52,20,25,15,84));
        window.testCases.push(new TestCase(9,36,44,7,27,88));
        window.testCases.push(new TestCase(10,6,16,3,3,100));
        window.testCases.push(new TestCase(11,40,6,11,3,88));
        window.testCases.push(new TestCase(12,18,30,7,3,76));
        window.testCases.push(new TestCase(13,60,28,19,13,100));
        window.testCases.push(new TestCase(14,6,58,3,39,90));
        window.testCases.push(new TestCase(15,42,14,35,11,90));
        window.testCases.push(new TestCase(16,28,30,17,7,88));
        window.testCases.push(new TestCase(17,16,40,9,27,78));
        window.testCases.push(new TestCase(18,38,24,31,9,60));
        window.testCases.push(new TestCase(19,56,38,41,33,30));
        window.testCases.push(new TestCase(20,36,44,33,11,90));
        window.testCases.push(new TestCase(21,60,6,33,3,100));
        window.testCases.push(new TestCase(22,20,48,13,45,42));
        window.testCases.push(new TestCase(23,14,56,7,33,82));
        window.testCases.push(new TestCase(24,30,48,19,13,56));
        window.testCases.push(new TestCase(25,38,16,23,5,76));
        window.testCases.push(new TestCase(26,42,12,13,7,68));
        window.testCases.push(new TestCase(27,56,8,41,3,88));
        window.testCases.push(new TestCase(28,42,22,5,13,82));
        window.testCases.push(new TestCase(29,16,6,7,3,94));
        window.testCases.push(new TestCase(30,42,58,9,31,84));
        window.testCases.push(new TestCase(31,48,56,17,45,48));
        window.testCases.push(new TestCase(32,6,54,3,13,100));
        window.testCases.push(new TestCase(33,16,34,3,15,90));
        window.testCases.push(new TestCase(34,28,44,11,5,98));
        window.testCases.push(new TestCase(35,6,14,3,7,68));
        window.testCases.push(new TestCase(36,48,42,31,35,100));
        window.testCases.push(new TestCase(37,20,16,11,3,86));
        window.testCases.push(new TestCase(38,60,60,31,31,100));
        window.testCases.push(new TestCase(39,42,38,35,17,70));
        window.testCases.push(new TestCase(40,60,60,49,27,98));
        window.testCases.push(new TestCase(41,52,30,39,17,100));
        window.testCases.push(new TestCase(42,40,58,29,29,74));
        window.testCases.push(new TestCase(43,18,42,9,3,76));
        window.testCases.push(new TestCase(44,54,54,13,33,88));
        window.testCases.push(new TestCase(45,52,30,7,5,80));
        window.testCases.push(new TestCase(46,10,18,5,9,100));
        window.testCases.push(new TestCase(47,50,60,31,21,94));
        window.testCases.push(new TestCase(48,36,44,13,17,50));
        window.testCases.push(new TestCase(49,26,40,5,9,44));
        window.testCases.push(new TestCase(50,6,6,3,3,100));
        window.testCases.push(new TestCase(51,54,26,17,19,60));
        window.testCases.push(new TestCase(52,26,6,13,3,60));
        window.testCases.push(new TestCase(53,34,32,21,19,94));
        window.testCases.push(new TestCase(54,16,20,9,3,96));
        window.testCases.push(new TestCase(55,42,56,17,7,92));
        window.testCases.push(new TestCase(56,46,38,7,29,98));
        window.testCases.push(new TestCase(57,40,10,21,7,76));
        window.testCases.push(new TestCase(58,28,34,23,17,92));
        window.testCases.push(new TestCase(59,14,36,7,11,90));
        window.testCases.push(new TestCase(60,26,24,11,17,96));
        window.testCases.push(new TestCase(61,10,22,5,15,72));
        window.testCases.push(new TestCase(62,44,26,27,13,52));
        window.testCases.push(new TestCase(63,30,52,25,43,62));
        window.testCases.push(new TestCase(64,26,28,3,3,16));
        window.testCases.push(new TestCase(65,10,22,3,7,72));
        window.testCases.push(new TestCase(66,6,50,3,29,62));
        window.testCases.push(new TestCase(67,14,46,3,41,72));
        window.testCases.push(new TestCase(68,44,34,37,3,82));
        window.testCases.push(new TestCase(69,20,34,11,31,90));
        window.testCases.push(new TestCase(70,32,24,11,19,90));
        window.testCases.push(new TestCase(71,26,46,21,13,24));
        window.testCases.push(new TestCase(72,6,12,3,9,62));
        window.testCases.push(new TestCase(73,22,28,19,25,64));
        window.testCases.push(new TestCase(74,38,14,19,7,72));
        window.testCases.push(new TestCase(75,50,46,29,19,96));
        window.testCases.push(new TestCase(76,48,14,9,7,62));
        window.testCases.push(new TestCase(77,22,48,3,35,80));
        window.testCases.push(new TestCase(78,36,14,25,3,78));
        window.testCases.push(new TestCase(79,8,32,5,3,24));
        window.testCases.push(new TestCase(80,54,22,7,11,70));
        window.testCases.push(new TestCase(81,16,40,13,35,40));
        window.testCases.push(new TestCase(82,60,6,3,3,100));
        window.testCases.push(new TestCase(83,10,10,5,7,80));
        window.testCases.push(new TestCase(84,20,34,17,21,38));
        window.testCases.push(new TestCase(85,60,60,3,3,100));
        window.testCases.push(new TestCase(86,8,10,5,5,96));
        window.testCases.push(new TestCase(87,44,56,7,17,76));
        window.testCases.push(new TestCase(88,6,44,3,21,76));
        window.testCases.push(new TestCase(89,46,54,37,43,48));
        window.testCases.push(new TestCase(90,52,16,29,7,2));
        window.testCases.push(new TestCase(91,22,18,15,3,86));
        window.testCases.push(new TestCase(92,38,22,29,17,98));
        window.testCases.push(new TestCase(93,10,10,3,3,100));
        window.testCases.push(new TestCase(94,32,50,17,21,36));
        window.testCases.push(new TestCase(95,28,46,3,41,98));
        window.testCases.push(new TestCase(96,16,42,5,31,72));
        window.testCases.push(new TestCase(97,18,38,7,29,78));
        window.testCases.push(new TestCase(98,6,30,3,17,42));
        window.testCases.push(new TestCase(99,22,18,15,13,52));
        window.testCases.push(new TestCase(100,54,56,19,19,84));
        
        var dropdown = document.getElementById("currentTest");
        for (var n=0; n<window.testCases.length; ++n) {
            var tc = window.testCases[n];
            dropdown.options[dropdown.options.length] = new Option("Case #"+tc.T+": "+(tc.H/2)+"x"+(tc.W/2),tc.T);
            solveTestCase(n);
        }
        var canvas = document.getElementById("myCanvas"); canvas.getContext("2d").clearRect(0,0,canvas.width,canvas.height);
    };
//]]>
</script></head><body>
<h1>Hello world!</h1>
<p>This is misof's solution+visualization for the task "Hall of Mirrors", easy subproblem.<br/>See the console log for the correct solution values, or use the dropdown to pick a test case to view.</p>
<select id="currentTest" onchange="dropdownHandler()"><option value=0>Pick a test case</option></select><br/>
<canvas id="myCanvas" width="1000" height="800"></canvas></body></html>
